<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Audio Flashcards</title>
    <style>
        :root {
            --primary-start: #667eea;
            --primary-end: #764ba2;
            --accent-start: #ff6b6b;
            --accent-end: #ff8e53;
            --quiz-start: #ff9a9e;
            --quiz-end: #fecfef;
            --play-start: #4facfe;
            --play-end: #00f2fe;
            --correct-start: #48bb78;
            --correct-end: #68d391;
            --incorrect-start: #f56565;
            --incorrect-end: #fc8181;
            --new-color: #ffa500;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, var(--primary-start) 0%, var(--primary-end) 100%);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 20px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .controls {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
            justify-content: center;
            max-width: 1200px;
        }
        
        .select-group {
            display: flex;
            gap: 10px;
            background: rgba(255,255,255,0.2);
            padding: 8px;
            border-radius: 25px;
            backdrop-filter: blur(10px);
        }

        .select-group select {
            background: transparent;
            border: none;
            color: white;
            font-size: 0.9rem;
            padding: 5px;
            border-radius: 5px;
            cursor: pointer;
        }

        .select-group select:focus {
            outline: none;
        }

        .select-group select option {
            background: var(--primary-end);
            color: white;
        }

        .btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
            padding: 10px 18px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .btn:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .btn.active {
            background: rgba(255,255,255,0.4);
            border-color: rgba(255,255,255,0.6);
            box-shadow: 0 0 10px rgba(255,255,255,0.3);
        }
        
        .quiz-btn {
            background: linear-gradient(45deg, var(--quiz-start), var(--quiz-end));
            color: #333;
            font-weight: bold;
        }

        .play-all-btn {
            background: linear-gradient(45deg, var(--play-start), var(--play-end));
        }

        .stop-btn {
            background: linear-gradient(45deg, var(--accent-start), var(--accent-end));
        }

        .cards-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            max-width: 1200px;
            width: 100%;
            padding: 20px;
        }

        .card {
            width: 100%;
            height: 320px;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.6s ease, opacity 0.5s ease;
            cursor: pointer;
        }

        .card.flipped {
            transform: rotateY(180deg);
        }

        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            padding: 20px;
        }

        .card-back {
            transform: rotateY(180deg);
            background: rgba(255,255,255,0.98);
        }

        .card-image {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, var(--accent-start), var(--play-start));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            margin-bottom: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .word-english {
            font-size: 2rem;
            font-weight: bold;
            color: #4a5568;
            margin-bottom: 10px;
            text-align: center;
            direction: ltr;
        }

        .word-translation {
            font-size: 1.5rem;
            color: #2d3748;
            margin-bottom: 15px;
            text-align: center;
            font-weight: 500;
        }

        .word-type {
            font-size: 0.9rem;
            color: #718096;
            background: rgba(113, 128, 150, 0.1);
            padding: 5px 12px;
            border-radius: 15px;
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .audio-btn {
            background: linear-gradient(45deg, var(--accent-start), var(--accent-end));
            color: white; border: none; padding: 10px 16px; border-radius: 20px; cursor: pointer; font-size: 0.9rem;
            transition: all 0.3s ease; display: flex; align-items: center; gap: 8px;
        }

        .audio-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4);
        }

        /* Quiz Mode Styles */
        .quiz-input { width: 100%; padding: 12px; margin: 15px 0; border: 2px solid #e2e8f0; border-radius: 10px; font-size: 1.2rem; text-align: center; outline: none; }
        .quiz-input:focus { border-color: var(--play-start); box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.1); }
        .quiz-buttons { display: flex; gap: 10px; margin-top: 10px; }
        .check-btn { flex: 1; background: linear-gradient(45deg, var(--correct-start), var(--correct-end)); color: white; border: none; padding: 10px; border-radius: 15px; cursor: pointer; font-size: 0.9rem; }
        .wrong-btn { flex: 1; background: linear-gradient(45deg, var(--incorrect-start), var(--incorrect-end)); color: white; border: none; padding: 10px; border-radius: 15px; cursor: pointer; font-size: 0.9rem; }
        .quiz-result { margin-top: 10px; padding: 8px; border-radius: 10px; text-align: center; font-weight: bold; }
        .correct { background: #c6f6d5; color: #2f855a; }
        .incorrect { background: #fed7d7; color: #c53030; }

        .card.hidden { display: none; }

        .stats {
            background: rgba(255,255,255,0.1); color: white; padding: 15px 25px; border-radius: 15px; margin-bottom: 20px; text-align: center; backdrop-filter: blur(10px); font-size: 0.9rem;
        }

        .card-number {
            position: absolute; top: 10px; right: 10px; background: rgba(0,0,0,0.1); color: #666; padding: 3px 8px; border-radius: 10px; font-size: 0.8rem;
        }
        
        .new-badge {
            position: absolute;
            top: -10px;
            right: -10px;
            background: var(--new-color);
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
            transform: rotate(15deg);
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        /* Notification Toast */
        .toast-notification { position: fixed; top: 20px; left: 50%; transform: translateX(-50%); background-color: #333; color: white; padding: 15px 25px; border-radius: 10px; z-index: 2000; opacity: 0; visibility: hidden; transition: opacity 0.3s, top 0.3s, visibility 0.3s; box-shadow: 0 5px 15px rgba(0,0,0,0.3); }
        .toast-notification.show { top: 40px; opacity: 1; visibility: visible; }

        @media (max-width: 768px) {
            .cards-container { grid-template-columns: 1fr; gap: 15px; }
            .card { height: 280px; } .header h1 { font-size: 2rem; } .word-english { font-size: 1.8rem; }
            .word-translation { font-size: 1.3rem; } .controls { gap: 8px; } .btn { padding: 8px 14px; font-size: 0.8rem; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üéì English Audio Flashcards</h1>
        <p>Your personalized English learning journey</p>
    </div>

    <div class="stats" id="stats">Loading stats...</div>
    
    <div class="controls">
        <div class="select-group">
             <label for="categorySelect" style="color: white; padding: 5px;">Category:</label>
             <select id="categorySelect"></select>
             <label for="lessonSelect" style="color: white; padding: 5px;">Lesson:</label>
             <select id="lessonSelect"></select>
        </div>
    </div>
    
    <div class="controls">
         <button class="btn quiz-btn" onclick="toggleQuizMode()">üìù Quiz Mode</button>
         <button class="btn" onclick="flipAllCards()">üîÑ Flip All</button>
         <button class="btn play-all-btn" id="playAllBtn" onclick="togglePlayAll()">üéµ Play All</button>
    </div>

    <div class="controls">
        <button class="btn voice-btn active" onclick="setVoice('american')" id="americanBtn">üá∫üá∏ American</button>
        <button class="btn voice-btn" onclick="setVoice('british')" id="britishBtn">üá¨üáß British</button>
    </div>

    <div class="cards-container" id="cardsContainer"></div>
    
    <div id="toast" class="toast-notification"></div>

    <script type="module">
        const wordSets = {
            "General Vocabulary": {
                "Classroom Commands": [
                    { english: "close your book", translation: "ÿßŸÇŸÅŸÑ ŸÉÿ™ÿßÿ®ŸÉ", type: "command", emoji: "üìñ" },
                    { english: "open", translation: "ÿßŸÅÿ™ÿ≠", type: "verb", emoji: "üìÇ" },
                    { english: "sit down", translation: "ÿßÿ¨ŸÑÿ≥", type: "command", emoji: "üí∫" },
                    { english: "stand up", translation: "ŸÇŸÅ", type: "command", emoji: "üßç" },
                    { english: "raise hand", translation: "ÿßÿ±ŸÅÿπ ŸäÿØŸÉ", type: "command", emoji: "üôã" },
                ],
                "Colors": [
                    { english: "colors", translation: "ÿ£ŸÑŸàÿßŸÜ", type: "noun", emoji: "üåà" },
                    { english: "blue", translation: "ÿ£ÿ≤ÿ±ŸÇ", type: "adjective", emoji: "üíô" },
                    { english: "green", translation: "ÿ£ÿÆÿ∂ÿ±", type: "adjective", emoji: "üíö" },
                    { english: "red", translation: "ÿ£ÿ≠ŸÖÿ±", type: "adjective", emoji: "‚ù§Ô∏è" },
                    { english: "yellow", translation: "ÿ£ÿµŸÅÿ±", type: "adjective", emoji: "üíõ" },
                    { english: "orange", translation: "ÿ®ÿ±ÿ™ŸÇÿßŸÑŸä", type: "adjective", emoji: "üß°" },
                ],
                "Shapes": [
                     { english: "shapes", translation: "ÿ£ÿ¥ŸÉÿßŸÑ", type: "noun", emoji: "üî∑" },
                     { english: "triangle", translation: "ŸÖÿ´ŸÑÿ´", type: "noun", emoji: "üî∫" },
                     { english: "square", translation: "ŸÖÿ±ÿ®ÿπ", type: "noun", emoji: "‚¨ú" },
                     { english: "circle", translation: "ÿØÿßÿ¶ÿ±ÿ©", type: "noun", emoji: "‚≠ï" },
                ],
                "Action Verbs": [
                    { english: "kick", translation: "Ÿäÿ±ŸÉŸÑ", type: "verb", emoji: "ü¶µ" },
                    { english: "run", translation: "Ÿäÿ¨ÿ±Ÿä", type: "verb", emoji: "üèÉ‚Äç‚ôÇÔ∏è" },
                    { english: "throw", translation: "Ÿäÿ±ŸÖŸä", type: "verb", emoji: "ü§æ‚Äç‚ôÇÔ∏è" },
                    { english: "hear", translation: "Ÿäÿ≥ŸÖÿπ", type: "verb", emoji: "üëÇ" },
                    { english: "eat", translation: "Ÿäÿ£ŸÉŸÑ", type: "verb", emoji: "üçΩÔ∏è" },
                    { english: "touch", translation: "ŸäŸÑŸÖÿ≥", type: "verb", emoji: "‚úã" },
                    { english: "sing", translation: "Ÿäÿ∫ŸÜŸä", type: "verb", emoji: "üé§" },
                    { english: "read", translation: "ŸäŸÇÿ±ÿ£", type: "verb", emoji: "üìñ" },
                    { english: "swim", translation: "Ÿäÿ≥ÿ®ÿ≠", type: "verb", emoji: "üèä‚Äç‚ôÇÔ∏è" },
                    { english: "write", translation: "ŸäŸÉÿ™ÿ®", type: "verb", emoji: "‚úçÔ∏è" },
                    { english: "clean", translation: "ŸäŸÜÿ∏ŸÅ", type: "verb", emoji: "üßΩ" },
                    { english: "draw", translation: "Ÿäÿ±ÿ≥ŸÖ", type: "verb", emoji: "üé®" },
                    { english: "play", translation: "ŸäŸÑÿπÿ®", type: "verb", emoji: "üéÆ" },
                ],
                "Nouns": [
                    { english: "hand", translation: "ŸäÿØ", type: "noun", emoji: "‚úã" },
                    { english: "picture", translation: "ÿµŸàÿ±ÿ©", type: "noun", emoji: "üñºÔ∏è" }
                ]
            },
            "Our World - Book 1": {
                "Unit 1: Fun in Class": [
                    { english: "reading", translation: "ŸÇÿ±ÿßÿ°ÿ©", type: "verb", emoji: "üìñ", isNew: true },
                    { english: "counting", translation: "ÿπÿØ", type: "verb", emoji: "üî¢", isNew: true },
                    { english: "colouring", translation: "ÿ™ŸÑŸàŸäŸÜ", type: "verb", emoji: "üñçÔ∏è", isNew: true },
                    { english: "listening", translation: "ÿßÿ≥ÿ™ŸÖÿßÿπ", type: "verb", emoji: "üéß", isNew: true },
                    { english: "cutting", translation: "ŸÇÿµ", type: "verb", emoji: "‚úÇÔ∏è", isNew: true },
                    { english: "writing", translation: "ŸÉÿ™ÿßÿ®ÿ©", type: "verb", emoji: "‚úçÔ∏è", isNew: true },
                    { english: "drawing", translation: "ÿ±ÿ≥ŸÖ", type: "verb", emoji: "üé®", isNew: true },
                    { english: "gluing", translation: "ŸÑÿµŸÇ", type: "verb", emoji: "üß¥", isNew: true },
                    { english: "talking", translation: "ÿ™ÿ≠ÿØÿ´", type: "verb", emoji: "üí¨", isNew: true },
                    { english: "rubbing out", translation: "ŸÖÿ≠Ÿà", type: "verb", emoji: "üßº", isNew: true },
                    { english: "glue", translation: "ÿµŸÖÿ∫", type: "noun", emoji: "üß¥", isNew: true },
                    { english: "a notebook", translation: "ÿØŸÅÿ™ÿ±", type: "noun", emoji: "üìì", isNew: true },
                    { english: "a felt tip", translation: "ŸÇŸÑŸÖ ŸÅŸÑŸàŸÖÿßÿ≥ÿ™ÿ±", type: "noun", emoji: "üñäÔ∏è", isNew: true },
                    { english: "scissors", translation: "ŸÖŸÇÿµ", type: "noun", emoji: "‚úÇÔ∏è", isNew: true },
                    { english: "a paintbrush", translation: "ŸÅÿ±ÿ¥ÿßÿ© ÿ±ÿ≥ŸÖ", type: "noun", emoji: "üñåÔ∏è", isNew: true }
                ]
            }
        };

        let currentFlashcards = [];
        let isPlayingAll = false;
        let isQuizMode = false;
        let currentVoice = 'american';

        // --- App State and Elements ---
        const categorySelect = document.getElementById('categorySelect');
        const lessonSelect = document.getElementById('lessonSelect');
        
        // --- UI Initialization and Rendering ---
        function initializeAppUI() {
            populateSelectors();
            loadLesson();
            setupEventListeners();
        }

        function renderUI() {
            isQuizMode ? createQuizCards() : createCards();
            updateStats();
        }

        function createCards() {
            const container = document.getElementById('cardsContainer');
            container.innerHTML = '';
            currentFlashcards.forEach((card, index) => {
                const cardElement = document.createElement('div');
                cardElement.className = 'card';
                cardElement.id = `card-${card.english.replace(/\s+/g, '-')}`;
                
                cardElement.innerHTML = `
                    <div class="card-face card-front">
                        ${card.isNew ? '<div class="new-badge">New</div>' : ''}
                        <div class="card-number">${index + 1}</div>
                        <div class="card-image">${card.emoji}</div>
                        <div class="word-type">${card.type}</div>
                        <div class="word-english">${card.english}</div>
                        <button class="audio-btn" data-word="${card.english}">üîä Listen</button>
                    </div>
                    <div class="card-face card-back">
                        <div class="card-image">${card.emoji}</div>
                        <div class="word-english" style="font-size: 1.8rem;">${card.english}</div>
                        <div class="word-translation">${card.translation}</div>
                        <button class="audio-btn" data-word="${card.english}">üîä Listen Again</button>
                    </div>
                `;
                container.appendChild(cardElement);
            });
        }
        
        function createQuizCards() {
             const container = document.getElementById('cardsContainer');
             container.innerHTML = '';
             currentFlashcards.forEach((card, index) => {
                 const cardElement = document.createElement('div');
                 cardElement.className = 'card';
                 cardElement.id = `card-${card.english.replace(/\s+/g, '-')}`;
                 cardElement.innerHTML = `
                     <div class="card-face quiz-face">
                         <div class="card-number">${index + 1}</div>
                         <div class="card-image">${card.emoji}</div>
                         <button class="audio-btn" data-word="${card.english}" style="margin-bottom: 15px;">üîä Listen</button>
                         <input type="text" class="quiz-input" placeholder="Type the English word..." data-answer="${card.english.toLowerCase()}" data-index="${index}" dir="ltr">
                         <div class="quiz-buttons">
                            <button class="check-btn" data-index="${index}">‚úì Check</button>
                            <button class="wrong-btn" data-index="${index}">‚ùå Show Answer</button>
                         </div>
                         <div class="quiz-result" id="result-${index}"></div>
                     </div>
                 `;
                 container.appendChild(cardElement);
             });
        }
        
        // --- Event Handling & UI Logic ---
        function setupEventListeners() {
            categorySelect.addEventListener('change', populateLessons);
            lessonSelect.addEventListener('change', loadLesson);
            document.getElementById('cardsContainer').addEventListener('click', handleCardClick);
        }

        function handleCardClick(e) {
            const cardElement = e.target.closest('.card');
            if (!cardElement) return;

            if (e.target.matches('.audio-btn')) {
                e.stopPropagation(); playAudio(e.target.dataset.word); return;
            }
            if (isQuizMode) {
                const index = e.target.dataset.index;
                if (e.target.matches('.check-btn')) checkAnswer(index);
                else if (e.target.matches('.wrong-btn')) showAnswer(index);
                return;
            }
            if (!isQuizMode) cardElement.classList.toggle('flipped');
        }

        function populateSelectors() {
            categorySelect.innerHTML = '';
            for (const category in wordSets) {
                const option = document.createElement('option');
                option.value = category;
                option.textContent = category;
                categorySelect.appendChild(option);
            }
            populateLessons();
        }

        function populateLessons() {
            const selectedCategory = categorySelect.value;
            lessonSelect.innerHTML = '';
            for (const lesson in wordSets[selectedCategory]) {
                const option = document.createElement('option');
                option.value = lesson;
                option.textContent = lesson;
                lessonSelect.appendChild(option);
            }
            loadLesson();
        }

        function loadLesson() {
            const selectedCategory = categorySelect.value;
            const selectedLesson = lessonSelect.value;
            currentFlashcards = [...wordSets[selectedCategory][selectedLesson]];
            renderUI();
        }
        
        function playAudio(word) {
             if ('speechSynthesis' in window) {
                speechSynthesis.cancel();
                const utterance = new SpeechSynthesisUtterance(word);
                utterance.lang = currentVoice === 'british' ? 'en-GB' : 'en-US';
                utterance.rate = 0.8;
                utterance.pitch = 1;
                speechSynthesis.speak(utterance);
             } else {
                 showToast('Browser does not support speech synthesis');
             }
        }
        
        window.toggleQuizMode = function() {
            isQuizMode = !isQuizMode;
            document.querySelector('.quiz-btn').classList.toggle('active', isQuizMode);
            renderUI();
        }

        window.checkAnswer = function(index) {
            const input = document.querySelector(`input[data-index="${index}"]`);
            const result = document.getElementById(`result-${index}`);
            if (input.value.toLowerCase().trim() === input.dataset.answer) {
                result.textContent = '‚úÖ Correct! Well done!'; result.className = 'quiz-result correct';
            } else {
                result.innerHTML = `‚ùå Incorrect. The answer is: <strong>${currentFlashcards[index].english}</strong>`;
                result.className = 'quiz-result incorrect';
            }
        }

        window.showAnswer = function(index) {
             document.getElementById(`result-${index}`).innerHTML = `üí° Answer: <strong>${currentFlashcards[index].english}</strong>`;
        }
        
        window.flipAllCards = function() {
            if (isQuizMode) return;
            document.querySelectorAll('.card:not(.hidden)').forEach(card => card.classList.toggle('flipped'));
        }

        window.togglePlayAll = function() { isPlayingAll ? stopPlayAll() : playAllCards(); }
        
        function stopPlayAll() {
            isPlayingAll = false;
            speechSynthesis.cancel();
            document.getElementById('playAllBtn').classList.remove('stop-btn');
            document.querySelectorAll('.card').forEach(c => c.style.transform = '');
        }

        function playAllCards() {
            isPlayingAll = true;
            document.getElementById('playAllBtn').classList.add('stop-btn');
            const visibleCards = Array.from(document.querySelectorAll('.card:not(.hidden)'));
            let currentIndex = 0;
            
            function playNext() {
                if (currentIndex >= visibleCards.length || !isPlayingAll) return stopPlayAll();
                const cardElement = visibleCards[currentIndex];
                const word = cardElement.querySelector('.audio-btn').dataset.word;

                document.querySelectorAll('.card').forEach(c => c.style.transform = '');
                cardElement.style.transform = 'scale(1.05)';
                cardElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
                
                const utterance = new SpeechSynthesisUtterance(word);
                utterance.lang = currentVoice === 'british' ? 'en-GB' : 'en-US';
                utterance.rate = 0.7;
                utterance.onend = () => { if (isPlayingAll) setTimeout(playNext, 1200); };
                speechSynthesis.speak(utterance);
                currentIndex++;
            }
            playNext();
        }

        window.setVoice = function(voice) {
             currentVoice = voice;
             document.querySelectorAll('.voice-btn').forEach(btn => btn.classList.remove('active'));
             document.getElementById(voice === 'american' ? 'americanBtn' : 'britishBtn').classList.add('active');
        }

        function updateStats() {
            const total = currentFlashcards.length;
            document.getElementById('stats').textContent = `Lesson Total: ${total}`;
        }

        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        // Initialize App
        initializeAppUI();

    </script>
</body>
</html>

